"use strict";(self["webpackChunkta404_ui_cli"]=self["webpackChunkta404_ui_cli"]||[]).push([[3394],{32220:function(e,t,i){i.r(t),i.d(t,{default:function(){return q}});var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"fit",attrs:{id:"app"}},[i("ta-border-layout",{attrs:{layout:{header:"70px"},centerCfg:{showBar:!0,toolBarStyle:{height:"50px",lineHeight:"48px"}}}},[i("div",{staticClass:"center-box",attrs:{slot:"header"},slot:"header"},[i("ta-input-search",{staticClass:"search-box",attrs:{placeholder:"操作事件",enterButton:"搜索"},on:{search:e.searchQuery},model:{value:e.param,callback:function(t){e.param=t},expression:"param"}})],1),i("div",{attrs:{slot:"centerExtraContent"},slot:"centerExtraContent"},[i("ta-tag-select",{attrs:{title:"审核状态",data:e.CollectionData("EXAMINEISCHECK"),"is-multi":!0},on:{change:e.fnQuery},model:{value:e.isCheckParam,callback:function(t){e.isCheckParam=t},expression:"isCheckParam"}}),e._v(" 创建时间： "),i("ta-range-picker",{attrs:{placeholder:["创建开始时间","创建结束时间"],"get-calendar-container":e.getContainer},on:{change:e.onChangeTime},model:{value:e.createTime,callback:function(t){e.createTime=t},expression:"createTime"}}),i("div",{staticStyle:{float:"right"}},[i("ta-button",{attrs:{icon:"area-chart"},on:{click:function(t){return e.showChart()}}})],1)],1),i("div",[i("ta-table",{attrs:{rowKey:"id",columns:e.columns,dataSource:e.gridData,pagination:!1,locale:{filterConfirm:"确定",filterReset:"重置",emptyText:"暂无数据"}},scopedSlots:e._u([{key:"opName",fn:function(t,s){return i("span",{},[i("a",{on:{click:function(t){return e.showDetail(s)}}},[e._v(e._s(t))])])}},{key:"opUsername",fn:function(t){return i("span",{},[e._v(e._s(t))])}},{key:"checkStatus",fn:function(t){return i("span",{},[0==t?[e._v(" 待审核 ")]:[e._v(" "+e._s(e.CollectionLabel("EXAMINEISCHECK",t))+" ")]],2)}},{key:"createTime",fn:function(t){return i("span",{},[e._v(e._s(t))])}},{key:"updateTime",fn:function(t){return i("span",{},[e._v(e._s(t))])}}])}),i("ta-pagination",{ref:"gridPager",staticStyle:{float:"right","margin-top":"10px"},attrs:{showSizeChanger:"",showQuickJumper:"",dataSource:e.gridData,defaultPageSize:10,params:e.pageParams,url:e.searchUrl},on:{"update:dataSource":function(t){e.gridData=t},"update:data-source":function(t){e.gridData=t}}})],1)]),i("ta-modal",{attrs:{centered:"",width:"800px",bodyStyle:{height:"500px",padding:"0"},footer:null,destroyOnClose:!0,maskClosable:!0,title:"数据分析(默认显示最近7天)",closable:!0},on:{close:function(t){return e.closeChart(!1)}},model:{value:e.showChartVisible,callback:function(t){e.showChartVisible=t},expression:"showChartVisible"}},[i("examine-chart",{ref:"examineChart",attrs:{queryData:e.queryData},on:{closeModal:e.closeChart}})],1),i("show-org",{attrs:{visible:e.orgEditVisible,rowData:e.rowData,tags:e.tags},on:{close:function(t){e.orgEditVisible=!1}}}),e.orgAddVisible?i("show-org-add",{attrs:{visible:e.orgAddVisible,rowData:e.rowData,tags:e.tags,chooseResult:e.chooseResult},on:{close:function(t){e.orgAddVisible=!1}}}):e._e(),i("show-org-batch",{attrs:{visible:e.orgBatchVisible,"row-data":e.rowData,tags:e.tags},on:{close:function(t){e.orgBatchVisible=!1}}}),e.userAddVisible?i("show-add-user",{attrs:{visible:e.userAddVisible,rowData:e.rowData,chooseUserResult:e.chooseUserResult},on:{close:function(t){e.userAddVisible=!1}}}):e._e(),i("show-edit-user",{attrs:{visible:e.userEditVisible,rowData:e.rowData},on:{close:function(t){e.userEditVisible=!1}}}),i("show-user-edit-org",{attrs:{visible:e.userEditOrgVisible,rowData:e.rowData},on:{close:function(t){e.userEditOrgVisible=!1}}}),i("show-user-batch",{attrs:{visible:e.userBatchVisible,"row-data":e.rowData,tags:e.tags,roleUserVisible:e.roleUserVisible},on:{close:function(t){e.userBatchVisible=!1}}}),i("show-add-role",{attrs:{visible:e.roleAddVisible,rowData:e.rowData,chooseRoleResult:e.chooseRoleResult,adminRole:e.adminRole},on:{close:function(t){e.roleAddVisible=!1}}}),i("show-edit-role",{attrs:{visible:e.roleEditVisible,rowData:e.rowData,chooseRoleResult:e.chooseRoleResult,adminRole:e.adminRole},on:{close:function(t){e.roleEditVisible=!1}}}),i("show-role-batch",{attrs:{visible:e.roleBatchVisible,"row-data":e.rowData,userRoleVisible:e.userRoleVisible},on:{close:function(t){e.roleBatchVisible=!1}}}),i("show-copy-role",{attrs:{visible:e.copyRoleVisible,rowData:e.rowData},on:{close:function(t){e.copyRoleVisible=!1}}}),i("show-copy-resource",{attrs:{visible:e.copyResourceVisible,rowData:e.rowData},on:{close:function(t){e.copyResourceVisible=!1}}}),i("show-similar-authority",{attrs:{visible:e.similarAuthorityVisible,rowData:e.rowData},on:{close:function(t){e.similarAuthorityVisible=!1}}}),i("show-agent-authority",{attrs:{visible:e.agentAuthorityVisible,rowData:e.rowData},on:{close:function(t){e.agentAuthorityVisible=!1}}}),i("show-agent-authority-batch",{attrs:{visible:e.agentAuthorityBatchVisible,rowData:e.rowData},on:{close:function(t){e.agentAuthorityBatchVisible=!1}}}),i("show-use-permission-authority",{attrs:{visible:e.usePermissionVisible,rowData:e.rowData},on:{close:function(t){e.usePermissionVisible=!1}}}),i("show-custom-resource-use-permission",{attrs:{visible:e.customResourceUsePermissionVisible,rowData:e.rowData},on:{close:function(t){e.customResourceUsePermissionVisible=!1}}}),i("show-custom-resource-authority",{attrs:{visible:e.customResourceAuthorityVisible,rowData:e.rowData},on:{close:function(t){e.customResourceAuthorityVisible=!1}}}),i("show-resource-authority",{attrs:{visible:e.resourceAuthorityVisible,rowData:e.rowData},on:{close:function(t){e.resourceAuthorityVisible=!1}}}),i("show-batch-op-authority",{attrs:{visible:e.batchOpAuthorityVisible,rowData:e.rowData},on:{close:function(t){e.batchOpAuthorityVisible=!1}}}),i("show-permission-effective-time-batch",{attrs:{visible:e.permissionEffectiveTimeBatchVisible,rowData:e.rowData},on:{close:function(t){e.permissionEffectiveTimeBatchVisible=!1}}}),i("show-org-scope",{attrs:{visible:e.orgScopeVisible,rowData:e.rowData},on:{close:function(t){e.orgScopeVisible=!1}}})],1)},o=[],a=i(36797),r=i.n(a),n=i(46979),l=i(64672),c=i(34278),h=i(40286),u=i(88728),d=i(59590),m=i(2431),b=i(57701),p=i(66921),f=i(55553),w=i(24740),V=i(67111),y=i(52782),g=i(13946),D=i(66965),R=i(69593),x=i(72470),A=i(72331),O=i(18357),v=i(99325),E=i(6782),C=i(4036),T=i(41643),S=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{height:"100%","overflow-x":"auto"}},[i("div",{staticStyle:{padding:"30px 30px 0 50px"}},[i("ta-e-charts",{attrs:{chartsType:"chart",data:e.chartData,title:e.title,"data-empty":e.dataEmpty,settings:e.chartSettings,legend:e.legend}})],1)])},N=[],B=i(99440),k=(i(39551),{name:"examineChart",props:["queryData"],data:function(){return this.typeArr=["line","histogram","pie"],this.index=2,this.legend={bottom:-30},{chartData:{columns:["操作事件","操作事件统计数"],rows:[]},dataEmpty:!1,title:{subtext:"默认显示最近7天"},chartSettings:{type:this.typeArr[this.index]},chartsType:this.typeArr[this.index]}},components:{TaECharts:B.Z},mounted:function(){this.setValue()},methods:{setValue:function(){var e=this;this.dataEmpty=!1,this.chartData.rows=[],n.Z.examineChart(this.queryData,(function(t){0==Object.keys(t.examineChartData).length&&(e.dataEmpty=!0);for(var i=0;i<t.examineChartData.length;i++){var s=[];s={"操作事件":t.examineChartData[i].opName,"操作事件统计数":t.examineChartData[i].count},e.chartData.rows.push(s)}}))},changeType:function(){this.index++,this.index>=this.typeArr.length&&(this.index=0),this.chartSettings={type:this.typeArr[this.index]}}}}),U=k,Z=i(1001),_=(0,Z.Z)(U,S,N,!1,null,null,null),P=_.exports,I=[{title:"操作事件",dataIndex:"opName",width:"15%",scopedSlots:{customRender:"opName"}},{title:"操作人",dataIndex:"opUsername",width:"10%",scopedSlots:{customRender:"opUsername"}},{title:"创建时间",dataIndex:"createTime",width:"20%",scopedSlots:{customRender:"createTime"}},{title:"审核时间",dataIndex:"updateTime",width:"20%",scopedSlots:{customRender:"updateTime"}},{title:"审核意见",dataIndex:"checkerOpinion",width:"20%",overflowTooltip:!0,scopedSlots:{customRender:"checkerOpinion"}},{title:"审核状态",dataIndex:"checkStatus",width:"10%",scopedSlots:{customRender:"checkStatus"}}],M={name:"examineManagementLog",data:function(){return{columns:I,gridData:[],tags:[],orgAddVisible:!1,showVisible:!1,orgEditVisible:!1,orgBatchVisible:!1,userAddVisible:!1,userEditVisible:!1,userEditOrgVisible:!1,userBatchVisible:!1,roleAddVisible:!1,roleEditVisible:!1,roleBatchVisible:!1,roleUserVisible:!1,userRoleVisible:!1,copyRoleVisible:!1,copyResourceVisible:!1,orgScopeVisible:!1,similarAuthorityVisible:!1,agentAuthorityVisible:!1,agentAuthorityBatchVisible:!1,permissionEffectiveTimeBatchVisible:!1,usePermissionVisible:!1,customResourceUsePermissionVisible:!1,customResourceAuthorityVisible:!1,batchOpAuthorityVisible:!1,resourceAuthorityVisible:!1,showChartVisible:!1,chooseResult:"",chooseUserResult:"",chooseRoleResult:"",adminRole:!1,currentExpand:[],createTime:[],createTimeStartDate:"",createTimeEndDate:"",isCheckParam:[],editType:"",rowData:{},selectedRowKeys:[],param:"",searchType:"",searchUrl:"examine/taExamineRestService/queryExamineLog",queryData:[]}},components:{showOrg:l.Z,showOrgAdd:c.Z,showOrgBatch:h.Z,showAddUser:u.Z,showEditUser:d.Z,showUserEditOrg:m.Z,showUserBatch:b.Z,showAddRole:p.Z,showEditRole:f.Z,showRoleBatch:w.Z,showCopyRole:V.Z,showOrgScope:C.Z,showCopyResource:y.Z,showSimilarAuthority:g.Z,showAgentAuthority:D.Z,showAgentAuthorityBatch:E.Z,showPermissionEffectiveTimeBatch:T.Z,showUsePermissionAuthority:R.Z,showCustomResourceUsePermission:x.Z,showCustomResourceAuthority:v.Z,showBatchOpAuthority:O.Z,showResourceAuthority:A.Z,examineChart:P},mounted:function(){this.fnQuery()},methods:{moment:r(),pageParams:function(){var e={};return this.isCheckParam.length&&(e.checkStatusArray=this.isCheckParam),e.createTimeStartDate=this.createTimeStartDate,e.createTimeEndDate=this.createTimeEndDate,e.opName=this.param,e},fnQuery:function(){this.$refs.gridPager.loadData()},searchQuery:function(){this.searchType="search",this.fnQuery()},onSelectChange:function(e,t){this.selectedRowKeys=e},showChart:function(){this.showChartVisible=!0,this.queryData={checkStatusArray:this.isCheckParam,opName:this.param,createTimeStartDate:this.createTimeStartDate,createTimeEndDate:this.createTimeEndDate}},closeChart:function(e){this.showChartVisible=!1},onChangeTime:function(e,t){t&&t.length&&""!=t[0]&&""!=t[1]?(this.createTimeStartDate=r()(t[0]).format("YYYY-MM-DD")+" 00:00:00",this.createTimeEndDate=r()(t[1]).format("YYYY-MM-DD")+" 23:59:59"):(this.createTimeStartDate="",this.createTimeEndDate=""),this.fnQuery()},showDetail:function(e){var t=this;this.rowData=e,this.tags=[],"ORG"==e.opObjectType?(n.Z.queryTags({type:"org"},(function(e){t.tags=e.data.tags})),-1!=e.opName.indexOf("新增")?(this.chooseResult="after",this.orgAddVisible=!0):-1!=e.opName.indexOf("更新")?this.orgEditVisible=!0:-1!=e.opName.indexOf("批量")?this.orgBatchVisible=!0:-1!=e.opName.indexOf("删除")&&(this.chooseResult="before",this.orgAddVisible=!0)):"USER"==e.opObjectType?-1!=e.opName.indexOf("新增")?(this.chooseUserResult="after",this.userAddVisible=!0):-1!=e.opName.indexOf("更新")?this.userEditVisible=!0:-1!=e.opName.indexOf("批量")?(this.roleUserVisible=!1,this.userBatchVisible=!0):-1!=e.opName.indexOf("删除")?(this.chooseUserResult="before",this.userAddVisible=!0):-1!=e.opName.indexOf("人员更改组织")?this.userEditOrgVisible=!0:(this.roleUserVisible=!1,this.userBatchVisible=!0):"ROLE"==e.opObjectType||"ADMIN_ROLE"==e.opObjectType?("ADMIN_ROLE"==e.opObjectType?this.adminRole=!0:this.adminRole=!1,-1!=e.opName.indexOf("新增")?(this.chooseRoleResult="after",this.roleAddVisible=!0):-1!=e.opName.indexOf("更新")?(this.chooseRoleResult="edit",this.roleEditVisible=!0):-1!=e.opName.indexOf("批量")?(this.roleBatchVisible=!0,this.userRoleVisible=!1):-1!=e.opName.indexOf("删除")?(this.chooseRoleResult="before",this.roleAddVisible=!0):(this.roleBatchVisible=!0,this.userRoleVisible=!1)):"ROLE_USER"==e.opObjectType?-1!=e.opName.indexOf("角色人员")?(this.userBatchVisible=!0,this.roleUserVisible=!0):-1!=e.opName.indexOf("人员角色")&&(this.roleBatchVisible=!0,this.userRoleVisible=!0):"ROLE_AUTHORITY"==e.opObjectType&&(-1!=e.opName.indexOf("角色复制")?this.copyRoleVisible=!0:-1!=e.opName.indexOf("权限复制")?this.copyResourceVisible=!0:-1!=e.opName.indexOf("管理员组织范围权限")?this.orgScopeVisible=!0:-1!=e.opName.indexOf("相似权限")?this.similarAuthorityVisible=!0:-1!=e.opName.indexOf("代理")?-1!=e.opName.indexOf("批量")?this.agentAuthorityBatchVisible=!0:this.agentAuthorityVisible=!0:-1!=e.opName.indexOf("有效时间")?this.permissionEffectiveTimeBatchVisible=!0:-1!=e.opName.indexOf("新增功能菜单权限")?this.usePermissionVisible=!0:-1!=e.opName.indexOf("新增自定义对象权限")?this.customResourceUsePermissionVisible=!0:-1!=e.opName.indexOf("批量收回")||-1!=e.opName.indexOf("批量授权")?this.batchOpAuthorityVisible=!0:-1!=e.opName.indexOf("再授权")&&(-1!=e.opName.indexOf("自定义权限")?this.customResourceAuthorityVisible=!0:this.resourceAuthorityVisible=!0))},getContainer:function(){return document.getElementById("app")}}},Y=M,j=(0,Z.Z)(Y,s,o,!1,null,"65d0bf82",null),q=j.exports}}]);